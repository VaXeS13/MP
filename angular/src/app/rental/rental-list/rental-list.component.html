<div class="container-fluid">
  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="h3 mb-0">
      <i class="fas fa-list-alt me-2"></i>
      {{ '::Rental:MyRentals' | abpLocalization }}
    </h2>
    <div>
      <a routerLink="/booths" class="btn btn-primary">
        <i class="fas fa-plus me-1"></i>
        {{ '::Rental:RentNewBooth' | abpLocalization }}
      </a>
    </div>
  </div>

  <!-- Loading State -->
  <div class="card" *ngIf="loading">
    <div class="card-body text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">{{ '::Common:Loading' | abpLocalization }}...</span>
      </div>
      <p class="mt-3 text-muted">{{ '::Rental:LoadingMessage' | abpLocalization }}</p>
    </div>
  </div>

  <!-- Empty State -->
  <div class="card" *ngIf="!loading && rentals.length === 0">
    <div class="card-body text-center py-5">
      <i class="fas fa-inbox fa-3x text-muted mb-3"></i>
      <h5>{{ '::Rental:NoRentalsTitle' | abpLocalization }}</h5>
      <p class="text-muted">{{ '::Rental:NoRentalsMessage' | abpLocalization }}</p>
      <a routerLink="/booths" class="btn btn-primary">
        <i class="fas fa-plus me-1"></i>
        {{ '::Rental:RentFirstBooth' | abpLocalization }}
      </a>
    </div>
  </div>

  <!-- Rentals List -->
  <div class="card" *ngIf="!loading && rentals.length > 0">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-hover">
          <thead class="table-dark">
            <tr>
              <th>{{ '::Common:Booth' | abpLocalization }}</th>
              <th>{{ '::Common:Period' | abpLocalization }}</th>
              <th>{{ '::Common:Status' | abpLocalization }}</th>
              <th>{{ '::Common:Payment' | abpLocalization }}</th>
              <th>{{ '::Common:Actions' | abpLocalization }}</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let rental of rentals">
              <td>
                <div>
                  <strong>{{ '::Common:Booth' | abpLocalization }} #{{ rental.boothNumber }}</strong>
                  <div class="small text-muted" *ngIf="rental.boothTypeName">
                    {{ '::Common:Type' | abpLocalization }}: {{ rental.boothTypeName }}
                  </div>
                </div>
              </td>
              <td>
                <div>
                  <strong>{{ rental.startDate | date:'shortDate' }}</strong>
                  <span class="text-muted mx-1">{{ '::Common:To' | abpLocalization }}</span>
                  <strong>{{ rental.endDate | date:'shortDate' }}</strong>
                </div>
                <div class="small text-muted">
                  {{ '::Common:Duration' | abpLocalization }}: {{ rental.daysCount }} {{ '::Common:Days' | abpLocalization }}
                </div>
              </td>
              <td>
                <span [class]="getStatusClass(rental.status)">
                  <i [class]="getStatusIcon(rental.status)" class="me-1"></i>
                  {{ rental.status }}
                </span>
                <div class="small text-muted mt-1" *ngIf="rental.startedAt">
                  {{ '::Rental:Started' | abpLocalization }}: {{ rental.startedAt | date:'short' }}
                </div>
              </td>
              <td>
                <div class="fw-bold text-success">
                  {{ rental.totalAmount | currency:'PLN':'symbol':'1.2-2' }}
                </div>
                <div class="small" [class]="rental.isPaid ? 'text-success' : 'text-warning'">
                  <i class="fas" [class]="rental.isPaid ? 'fa-check-circle' : 'fa-clock'"></i>
                  {{ rental.isPaid ? ('::Status:Paid' | abpLocalization) : ('::Status:Pending' | abpLocalization) }}
                  <div *ngIf="rental.paidDate">({{ rental.paidDate | date:'shortDate' }})</div>
                </div>
              </td>
              <td>
                <div class="btn-group btn-group-sm" role="group">
                  <button type="button"
                          class="btn btn-outline-primary"
                          (click)="viewRentalDetails(rental)"
                          [title]="'::Rental:ViewDetails' | abpLocalization">
                    <i class="fas fa-eye"></i>
                  </button>

                  <button type="button"
                          class="btn btn-outline-success"
                          *ngIf="canStartRental(rental)"
                          (click)="startRental(rental)"
                          [title]="'::Rental:StartRental' | abpLocalization">
                    <i class="fas fa-play"></i>
                  </button>

                  <button type="button"
                          class="btn btn-outline-warning"
                          *ngIf="canCompleteRental(rental)"
                          (click)="completeRental(rental)"
                          [title]="'::Rental:CompleteRental' | abpLocalization">
                    <i class="fas fa-stop"></i>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <div class="d-flex justify-content-between align-items-center mt-3" *ngIf="totalCount > pageSize">
        <div class="text-muted">
          {{ '::Rental:ShowingResults' | abpLocalization: { from: (pageIndex * pageSize) + 1, to: Math.min((pageIndex + 1) * pageSize, totalCount), total: totalCount } }}
        </div>
        <nav [attr.aria-label]="'::Rental:MyRentals' | abpLocalization">
          <ul class="pagination pagination-sm mb-0">
            <li class="page-item" [class.disabled]="pageIndex === 0">
              <button class="page-link"
                      (click)="onPageChange({first: 0, rows: pageSize})"
                      [disabled]="pageIndex === 0">
                {{ '::Common:First' | abpLocalization }}
              </button>
            </li>
            <li class="page-item" [class.disabled]="pageIndex === 0">
              <button class="page-link"
                      (click)="onPageChange({first: (pageIndex - 1) * pageSize, rows: pageSize})"
                      [disabled]="pageIndex === 0">
                {{ '::Common:Previous' | abpLocalization }}
              </button>
            </li>
            <li class="page-item" [class.disabled]="(pageIndex + 1) * pageSize >= totalCount">
              <button class="page-link"
                      (click)="onPageChange({first: (pageIndex + 1) * pageSize, rows: pageSize})"
                      [disabled]="(pageIndex + 1) * pageSize >= totalCount">
                {{ '::Common:Next' | abpLocalization }}
              </button>
            </li>
            <li class="page-item" [class.disabled]="(pageIndex + 1) * pageSize >= totalCount">
              <button class="page-link"
                      (click)="onPageChange({first: Math.floor(totalCount / pageSize) * pageSize, rows: pageSize})"
                      [disabled]="(pageIndex + 1) * pageSize >= totalCount">
                {{ '::Common:Last' | abpLocalization }}
              </button>
            </li>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>